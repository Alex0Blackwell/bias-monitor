(()=>{async function e(e,t){let s,a,n,c,o=!1;n=(new Date).getTime();try{a=new URL(t.url).hostname.replace("www.","");const e=await fetch("news_sites.csv"),s=await e.text();o=new Set(s.split("\n")).has(a)}catch(e){console.debug("There was an error parsing the tab url",e),o=!0}o?(console.debug(t.url,"is a news website."),s=["./scrape.js"]):(console.debug(a,"is not a news website."),s=["./not_news_event.js"]);try{await chrome.scripting.executeScript({target:{tabId:e},files:s})}catch(e){console.log(e)}c=(new Date).getTime();const i=(c-n)/1e3;console.debug("Done analyzing, took ",i,"seconds.")}chrome.tabs.onActivated.addListener((async t=>{chrome.tabs.query({active:!0,lastFocusedWindow:!0},(async function(s){const a=t.tabId,n=s[0];await e(a,n)}))})),chrome.tabs.onUpdated.addListener((async(t,s,a)=>{"complete"==s.status&&await e(t,a)}))})();