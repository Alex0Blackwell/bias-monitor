(()=>{const t=["google.com"];chrome.tabs.onUpdated.addListener((async(o,e,c)=>{if("complete"===e.status)try{let e=!1;const s=await fetch("newsites.txt"),l=(await s.text()).split("\n");for(const o of l)if(!(o.length<3)&&c.url.includes(o.trim())&&t.indexOf(o.trim())<0){console.log(c.url,o),chrome.storage.local.set({foo:5},(function(){console.log("Why is it not working?"),chrome.storage.local.get(["foo"],(function(t){console.log("Value currently is "+t.key)}))})),e=!0;break}e&&await chrome.scripting.executeScript({target:{tabId:o},files:["./scrape.js"]})}catch(t){console.log(t)}}))})();